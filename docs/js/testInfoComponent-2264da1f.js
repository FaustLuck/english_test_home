import{_ as M,d as m,a as u,m as p,t as y,c as T,b as k,e as _,B as w,o as n,h as f,f as c,x as a,i as d,j as s,F as C,l as I,n as L,r as g,p as D,k as B}from"./main-2dcca78f.js";import{s as F}from"./statisticStore-9bd0daa9.js";const R={name:"testInfoComponent",components:{itemPreloader:m(()=>u(()=>import("./itemPreloader-28c98b60.js"),["js/itemPreloader-28c98b60.js","js/main-2dcca78f.js","css/main-df3f9d20.css","css/itemPreloader-6b651cd2.css"])),preloaderComponent:m(()=>u(()=>import("./preloaderComponent-99da6f02.js"),["js/preloaderComponent-99da6f02.js","js/main-2dcca78f.js","css/main-df3f9d20.css","css/preloaderComponent-82881bbd.css"])),testDifficultComponent:m(()=>u(()=>import("./testDifficultComponent-c8024319.js"),["js/testDifficultComponent-c8024319.js","js/main-2dcca78f.js","css/main-df3f9d20.css","js/settingsStore-38e39a1e.js","css/testDifficultComponent-cfebc989.css"]))},props:{timestamp:Number,testInfo:Object,sub:String,heightTitle:Number},data(){var t,e;return{displayMode:0,date:0,time:0,localTest:null,localTimeSpent:(t=this.testInfo)==null?void 0:t.timeSpent,localTimeLeft:(e=this.testInfo)==null?void 0:e.timeLeft}},watch:{result(t){t&&this.mode==="result"&&(this.localTest=this.result,this.localTimeSpent=this.timeSpent,this.localTimeLeft=this.timeLeft,this.isCongratulation&&this.$emit("show","fire"),this.isFail&&this.$emit("show","fail"),this.setLoading(!1))},async sub(t){t&&await this.saveTest({sub:t})}},computed:{...p(y,["timeSpent","result","timeLeft"]),...p(T,["orderDifficult","isLoading","mode"]),...p(k,["name"]),length(){return this.mode==="result"?Object.values(this.result).reduce((t,e)=>t+e.length,0):this.testInfo.questions},correct(){return this.mode==="result"?Object.values(this.result).reduce((t,e)=>t+e.filter(r=>r.answer===(r==null?void 0:r.choice)).length,0):this.testInfo.correct},timeSpentToString(){let t=(this.localTimeSpent%60).toString().padStart(2,"0");return`${(this.localTimeSpent-t)/60}:${t}`},isCongratulation(){return this.length===this.correct},isFail(){return this.localTimeLeft===0}},methods:{..._(F,["getResult"]),..._(y,["checkTest","saveTest"]),..._(T,["setLoading"]),async changeDisplayMode(t){if(this.mode==="result"&&!this.localTest||(this.displayMode++,this.displayMode>2&&(this.displayMode=0),(this.isCongratulation||!this.correct)&&this.displayMode===1&&(this.displayMode=2),this.displayMode===0))return;await this.getResultFromBD();let e=t.target.closest(".info");setTimeout(()=>this.scroll(e),0)},async getResultFromBD(){this.localTest||(this.localTest=await this.getResult({sub:this.sub,timestamp:this.timestamp}))},scroll(t){let e=t.getBoundingClientRect().top;e!==this.heightTitle&&this.displayMode>0&&window.scrollBy({top:e-this.heightTitle,behavior:"smooth"})},filterTest(t){return this.localTest[t].filter(e=>e.answer!==(e==null?void 0:e.choice))}},async mounted(){[this.date,this.time]=w(this.timestamp),this.mode==="result"&&(await this.checkTest({sub:this.sub}),this.displayMode=2,this.sub&&await this.saveTest({sub:this.sub}))}},h=t=>(D("data-v-c42d5539"),t=t(),B(),t),E={key:0,class:"info__login"},O={class:"info__detail-clickable"},A={class:"info__detail"},P=h(()=>s("span",null,"Время тестирования:",-1)),V={class:"info__detail"},j=h(()=>s("span",null,"Кол-во верных ответов / вопросов:",-1)),N={class:"info__detail"},q=h(()=>s("span",null,"Времени затрачено:",-1)),z={key:0,class:"info__detail-fail"},G=h(()=>s("span",null,"Время вышло!",-1)),H=[G],J={key:2};function K(t,e,r,Q,i,o){const S=g("preloader-component"),v=g("item-preloader"),b=g("test-difficult-component");return t.isLoading&&t.mode==="result"?(n(),f(S,{key:0})):(n(),c("section",{key:1,class:L(["info",{fail:o.isFail&&t.mode!=="result"&&!i.displayMode,congratulation:o.isCongratulation&&t.mode!=="result"&&!i.displayMode}]),onClick:e[0]||(e[0]=(...l)=>o.changeDisplayMode&&o.changeDisplayMode(...l))},[t.mode==="result"?(n(),c("div",E,a(t.name?t.name:"Вход не выполнен"),1)):d("",!0),s("div",O,[s("div",A,[P,s("span",null,a(i.date)+" "+a(i.time),1)]),s("div",V,[j,s("span",null,a(o.correct)+" / "+a(o.length),1)]),s("div",N,[q,s("span",null,a(o.timeSpentToString),1)]),o.isFail&&t.mode==="result"?(n(),c("div",z,H)):d("",!0)]),i.displayMode>0&&!i.localTest?(n(),f(v,{key:1})):d("",!0),i.displayMode>0&&i.localTest?(n(),c("div",J,[(n(!0),c(C,null,I(t.orderDifficult,l=>(n(),f(b,{key:l,difficult:l,"part-answers":i.displayMode===1?o.filterTest(l):i.localTest[l]},null,8,["difficult","part-answers"]))),128))])):d("",!0)],2))}const X=M(R,[["render",K],["__scopeId","data-v-c42d5539"]]);export{X as default};
