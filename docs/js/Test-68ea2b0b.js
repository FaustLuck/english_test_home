import{d as h,n as i,_ as f,r as m,q,H as y,o as v,i as C,b as d,w as E,u as n,I as b,c as R,k as V,F as g}from"./main-7f3d3c9a.js";import{u as D}from"./history-be1a59b8.js";const A=h({__name:"Test",props:{sub:null,result:null},setup(o){const e=o,p=i(()=>f(()=>import("./ResultDetail-374ae43a.js"),["js/ResultDetail-374ae43a.js","js/main-7f3d3c9a.js","css/main-a045c51a.css"])),_=i(()=>f(()=>import("./ResultHeader-4c869687.js"),["js/ResultHeader-4c869687.js","js/main-7f3d3c9a.js","css/main-a045c51a.css","js/timeToString-e34e66a4.js"])),t=m(0),k=q(()=>{var s,r,u,l;if(t.value===0){if(((s=e.result.info)==null?void 0:s.timeLeft)===0)return"#ff8c69";if((r=e.result.info)!=null&&r.correct&&((u=e.result.info)==null?void 0:u.correct)===((l=e.result.info)==null?void 0:l.questions))return"#8fbc8f"}return"transparent"});let a=m(void 0);y(()=>{if(!e.result.test){a.value=void 0;return}switch(t.value){case 1:a.value={};for(const s in e.result.test)a.value[s]=e.result.test[s].filter(r=>r.answer!==r.choice);break;case 2:a.value=e.result.test;return}});async function w(){t.value++;const{correct:s,questions:r}=e.result.info;if(t.value>2&&(t.value=0),(s===r||s===0)&&t.value===1&&(t.value=2),t.value===0||e.result.test)return;const u=new Date(+e.result.timestamp).getFullYear();await D().getResult(e.sub,e.result.key,u)}return(s,r)=>(v(),C(g,null,[d(b,{onClick:w,color:n(k),elevation:"0",class:"pa-3"},{default:E(()=>{var u,l,c;return[d(n(_),{timestamp:o.result.timestamp,correct:(u=o.result.info)==null?void 0:u.correct,"time-spent":(l=o.result.info)==null?void 0:l.timeSpent,questions:(c=o.result.info)==null?void 0:c.questions},null,8,["timestamp","correct","time-spent","questions"])]}),_:1},8,["color"]),t.value>0?(v(),R(n(p),{key:0,result:n(a)},null,8,["result"])):V("",!0)],64))}});export{A as default};
