"use strict";(self["webpackChunkenglish_test_home"]=self["webpackChunkenglish_test_home"]||[]).push([[874],{3874:function(t,e,s){s.r(e),s.d(e,{default:function(){return M}});var i=s(3396),l=s(7139);const a=t=>((0,i.dD)("data-v-d6f85f1a"),t=t(),(0,i.Cn)(),t),n={key:0,class:"info__login"},o={class:"info__detail-clickable"},r={class:"info__detail"},h=a((()=>(0,i._)("span",null,"Время тестирования:",-1))),d={class:"info__detail"},c=a((()=>(0,i._)("span",null,"Кол-во верных ответов / вопросов:",-1))),u={class:"info__detail"},m=a((()=>(0,i._)("span",null,"Времени затрачено:",-1))),p={key:0,class:"info__detail-fail"},f=a((()=>(0,i._)("span",null,"Время вышло!",-1))),g=[f],_={key:2};function w(t,e,s,a,f,w){const y=(0,i.up)("preloader-component"),T=(0,i.up)("item-preloader"),b=(0,i.up)("test-difficult-component");return t.isLoading&&"result"===t.mode?((0,i.wg)(),(0,i.j4)(y,{key:0})):((0,i.wg)(),(0,i.iD)("section",{key:1,class:(0,l.C_)(["info",{fail:w.isFail&&"result"!==t.mode&&!f.displayMode,congratulation:w.isCongratulation&&"result"!==t.mode&&!f.displayMode}]),onClick:e[0]||(e[0]=(...t)=>w.changeDisplayMode&&w.changeDisplayMode(...t))},["result"===t.mode?((0,i.wg)(),(0,i.iD)("div",n,(0,l.zw)(t.name?t.name:"Вход не выполнен"),1)):(0,i.kq)("",!0),(0,i._)("div",o,[(0,i._)("div",r,[h,(0,i._)("span",null,(0,l.zw)(f.date)+" "+(0,l.zw)(f.time),1)]),(0,i._)("div",d,[c,(0,i._)("span",null,(0,l.zw)(w.correct)+" / "+(0,l.zw)(w.length),1)]),(0,i._)("div",u,[m,(0,i._)("span",null,(0,l.zw)(w.timeSpentToString),1)]),w.isFail&&"result"===t.mode?((0,i.wg)(),(0,i.iD)("div",p,g)):(0,i.kq)("",!0)]),f.displayMode>0&&!f.localTest?((0,i.wg)(),(0,i.j4)(T,{key:1})):(0,i.kq)("",!0),f.displayMode>0&&f.localTest?((0,i.wg)(),(0,i.iD)("div",_,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(t.orderDifficult,(t=>((0,i.wg)(),(0,i.j4)(b,{key:t,difficult:t,"part-answers":1===f.displayMode?w.filterTest(t):f.localTest[t]},null,8,["difficult","part-answers"])))),128))])):(0,i.kq)("",!0)],2))}var y=s(65),T=s(2648),b={name:"testInfoComponent",components:{itemPreloader:(0,i.RC)((()=>s.e(340).then(s.bind(s,340)))),preloaderComponent:(0,i.RC)((()=>s.e(437).then(s.bind(s,4437)))),testDifficultComponent:(0,i.RC)((()=>s.e(979).then(s.bind(s,3979))))},props:{timestamp:Number,testInfo:Object,sub:String,heightTitle:Number},data(){return{displayMode:0,date:0,time:0,localTest:null,localTimeSpent:this.testInfo?.timeSpent,localTimeLeft:this.testInfo?.timeLeft}},watch:{result(t){t&&"result"===this.mode&&(this.localTest=this.result,this.localTimeSpent=this.timeSpent,this.localTimeLeft=this.timeLeft,this.isCongratulation&&this.$emit("show","fire"),this.isFail&&this.$emit("show","fail"),this.setLoading(!1))},async sub(t){t&&await this.saveTest({sub:t})}},computed:{...(0,y.rn)("test",["timeSpent","result","timeLeft"]),...(0,y.rn)(["orderDifficult","isLoading","mode"]),...(0,y.rn)("auth",["name"]),length(){return"result"===this.mode?Object.values(this.result).reduce(((t,e)=>t+e.length),0):this.testInfo.questions},correct(){return"result"===this.mode?Object.values(this.result).reduce(((t,e)=>t+e.filter((t=>t.answer===t?.choice)).length),0):this.testInfo.correct},timeSpentToString(){let t=(this.localTimeSpent%60).toString().padStart(2,"0"),e=(this.localTimeSpent-t)/60;return`${e}:${t}`},isCongratulation(){return this.length===this.correct},isFail(){return 0===this.localTimeLeft}},methods:{...(0,y.nv)("statistic",["getResult"]),...(0,y.nv)("test",["checkTest","saveTest"]),...(0,y.OI)(["setLoading"]),async changeDisplayMode(t){if("result"===this.mode&&!this.localTest)return;if(this.displayMode++,this.displayMode>2&&(this.displayMode=0),!this.isCongratulation&&this.correct||1!==this.displayMode||(this.displayMode=2),0===this.displayMode)return;await this.getResultFromBD();let e=t.target.closest(".info");setTimeout((()=>this.scroll(e)),0)},async getResultFromBD(){this.localTest||(this.localTest=await this.getResult({sub:this.sub,timestamp:this.timestamp}))},scroll(t){let e=t.getBoundingClientRect().top;e!==this.heightTitle&&this.displayMode>0&&window.scrollBy({top:e-this.heightTitle,behavior:"smooth"})},filterTest(t){return this.localTest[t].filter((t=>t.answer!==t?.choice))}},async mounted(){[this.date,this.time]=(0,T._)(this.timestamp),"result"===this.mode&&(await this.checkTest({sub:this.sub}),this.displayMode=2,this.sub&&await this.saveTest({sub:this.sub}))}},v=s(89);const k=(0,v.Z)(b,[["render",w],["__scopeId","data-v-d6f85f1a"]]);var M=k}}]);