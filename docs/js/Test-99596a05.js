import{d as w,n as i,_ as f,r as m,p as y,H as C,o as v,h as E,b as d,w as b,u as n,I as q,c as R,k as V,F as g}from"./main-ecb08509.js";import{u as D}from"./history-594134c5.js";const A=w({__name:"Test",props:{sub:null,result:null},setup(o){const e=o,p=i(()=>f(()=>import("./ResultDetail-fdd36266.js"),["js/ResultDetail-fdd36266.js","js/main-ecb08509.js","css/main-a045c51a.css"])),_=i(()=>f(()=>import("./ResultHeader-c378f754.js"),["js/ResultHeader-c378f754.js","js/main-ecb08509.js","css/main-a045c51a.css","js/timeToString-e34e66a4.js"])),t=m(0),k=y(()=>{var s,r,u,l;if(t.value===0){if(((s=e.result.info)==null?void 0:s.timeLeft)===0)return"#ff8c69";if((r=e.result.info)!=null&&r.correct&&((u=e.result.info)==null?void 0:u.correct)===((l=e.result.info)==null?void 0:l.questions))return"#8fbc8f"}return"transparent"});let a=m(void 0);C(()=>{if(!e.result.test){a.value=void 0;return}switch(t.value){case 1:a.value={};for(const s in e.result.test)a.value[s]=e.result.test[s].filter(r=>r.answer!==r.choice);break;case 2:a.value=e.result.test;return}});async function h(){t.value++;const{correct:s,questions:r}=e.result.info;if(t.value>2&&(t.value=0),(s===r||s===0)&&t.value===1&&(t.value=2),t.value===0||e.result.test)return;const u=new Date(+e.result.timestamp).getFullYear();await D().getResult(e.sub,e.result.key,u)}return(s,r)=>(v(),E(g,null,[d(q,{onClick:h,color:n(k),elevation:"0",class:"pa-3"},{default:b(()=>{var u,l,c;return[d(n(_),{timestamp:o.result.timestamp,correct:(u=o.result.info)==null?void 0:u.correct,"time-spent":(l=o.result.info)==null?void 0:l.timeSpent,questions:(c=o.result.info)==null?void 0:c.questions},null,8,["timestamp","correct","time-spent","questions"])]}),_:1},8,["color"]),t.value>0?(v(),R(n(p),{key:0,result:n(a)},null,8,["result"])):V("",!0)],64))}});export{A as default};
